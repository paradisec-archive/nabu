%h1 Items Bulk Update

.right
  = link_to 'Advanced Search', advanced_search_items_path(:params => params.delete_if {|k,v| ['action', 'controller'].include? k})
.clear

%p== #{@search.total} search results

= render 'items/search_results'

= form_for @item, :url => bulk_update_items_path, :method => :put do |f|
  - if @item.errors.any?
    #error_explanation
      %h2== #{pluralize(@item.errors.count, 'error')} prohibited this post from being saved:
      %ul
        - @item.errors.full_messages.each do |msg|
          %li= msg

  = hidden_field_tag :item_ids, @search.results.map(&:id)
  = hidden_field_tag :original_search_params, params.to_a.delete_if {|p| ['action', 'controller'].include? p[0]}.map {|p| "#{p[0]}=#{p[1]}" }.join('&')

  .right
    = f.submit "Update #{@search.total} Items", :confirm => "This will update #{@search.total} items - are you sure?"

  = render :partial => 'items/form', :locals => {:f => f}

  .right
    = f.submit "Update #{@search.total} Items", :confirm => "This will update #{@search.total} items - are you sure?"

